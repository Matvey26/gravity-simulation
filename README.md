# gravity-simulation
Симулятор гравитации большого числа частиц

Написано на C++ с помощью SFML. Для ускорения вычислений используется алгоритм на основе квадродерева и критерия Бернса-Хата.

[Видео демонстрация](https://disk.yandex.ru/i/s6cboMvySZK2rg)

К сожалению, у текущей реализации есть несколько проблем.

**Во-первых**, скорость алгоритма напрямую зависит от количества частиц, хотя многие частицы даже не будут отрисованы, из-за низкого разрешения экрана. Хотелось бы, чтобы скорость зависела только от выбранного разрешения.

**Во-вторых**, чтобы избежать лагов, дерево приходится делать очень неглубоким, отчего расчёты становятся слишком грубыми. Особенно сильно это проявляется на краях областей квадродерева: частицы возле границы одной области летят быстрее, чем должны, а в соседней области, тоже возле границы, они летят медленнее, чем должны. Происходит накладывание - появляется характерная сеточка из частиц. Необходимо либо пытаться рандомно сдвигать положение дерева, чтобы усреднять ошибку вычислений, либо использовать подход, предложенный [в этом видео](https://youtu.be/GjbcvqEOIuE?si=jJYj1Ze99TslY1oK), основанный на разных уровнях детализации.

**В-третьх**, отрисовывать каждую частицу - долго и дорого, это O(N) вызовов графического API. Гораздо быстрее отрисовывать все частицы разом, но я не нашёл способа, как придать частицам радиус и полупрозрачность, для визуально более приятного эффекта. Гораздо эффективнее будет хранить изначально двумерный массив того же размера, что и экран. Если на каждом шаге на ходу также обрабатывать этот массив, мы сможем проще отрисовывать кадр, потому что у нас уже есть готовая текстура.